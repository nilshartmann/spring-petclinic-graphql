import{C as g}from"./codemirror.es-52e8b92d.js";import{s as w,N,E as D,K as L,v as R,a as b,L as S,U,b as C,c as I,d as P,e as Q,f as T,h as q,i as G,P as k,j as A,k as V,p as x,l as W,G as K,C as H,m as O,o as _}from"./index-ceabb893.js";import{R as E,P as p}from"./Range-52ddcb6a.js";import"./codemirror.es2-5884f31a.js";const $=[S,U,C,I,P,Q,T,q,G,k,A,V];function F(n,a,i,s,r){const e=w.filter(t=>!(t===N||t===D||s&&t===L));return i&&Array.prototype.push.apply(e,i),r&&Array.prototype.push.apply(e,$),R(n,a,e).filter(t=>{if(t.message.includes("Unknown directive")&&t.nodes){const l=t.nodes[0];if(l&&l.kind===b.DIRECTIVE){const u=l.name.value;if(u==="arguments"||u==="argumentDefinitions")return!1}}return!0})}const d={Error:"Error",Warning:"Warning",Information:"Information",Hint:"Hint"},h={[d.Error]:1,[d.Warning]:2,[d.Information]:3,[d.Hint]:4},f=(n,a)=>{if(!n)throw new Error(a)};function M(n,a=null,i,s,r){var e,o;let t=null,l="";r&&(l=typeof r=="string"?r:r.reduce((c,m)=>c+x(m)+`

`,""));const u=l?`${n}

${l}`:n;try{t=W(u)}catch(c){if(c instanceof K){const m=j((o=(e=c.locations)===null||e===void 0?void 0:e[0])!==null&&o!==void 0?o:{line:0,column:0},u);return[{severity:h.Error,message:c.message,source:"GraphQL: Syntax",range:m}]}throw c}return Y(t,a,i,s)}function Y(n,a=null,i,s){if(!a)return[];const r=F(a,n,i,s).flatMap(o=>v(o,h.Error,"Validation")),e=R(a,n,[O]).flatMap(o=>v(o,h.Warning,"Deprecation"));return r.concat(e)}function v(n,a,i){if(!n.nodes)return[];const s=[];for(const[r,e]of n.nodes.entries()){const o=e.kind!=="Variable"&&"name"in e&&e.name!==void 0?e.name:"variable"in e&&e.variable!==void 0?e.variable:e;if(o){f(n.locations,"GraphQL validation error requires locations.");const t=n.locations[r],l=z(o),u=t.column+(l.end-l.start);s.push({source:`GraphQL: ${i}`,message:n.message,severity:a,range:new E(new p(t.line-1,t.column-1),new p(t.line-1,u))})}}return s}function j(n,a){const i=_(),s=i.startState(),r=a.split(`
`);f(r.length>=n.line,"Query text must have more lines than where the error happened");let e=null;for(let u=0;u<n.line;u++)for(e=new H(r[u]);!e.eol()&&i.token(e,s)!=="invalidchar";);f(e,"Expected Parser stream to be available.");const o=n.line-1,t=e.getStartOfToken(),l=e.getCurrentPosition();return new E(new p(o,t),new p(o,l))}function z(n){const i=n.loc;return f(i,"Expected ASTNode to have a location."),i}const y=["error","warning","information","hint"],B={"GraphQL: Validation":"validation","GraphQL: Deprecation":"deprecation","GraphQL: Syntax":"syntax"};g.registerHelper("lint","graphql",(n,a)=>{const{schema:i,validationRules:s,externalFragments:r}=a;return M(n,i,s,void 0,r).map(e=>({message:e.message,severity:e.severity?y[e.severity-1]:y[0],type:e.source?B[e.source]:void 0,from:g.Pos(e.range.start.line,e.range.start.character),to:g.Pos(e.range.end.line,e.range.end.character)}))});
